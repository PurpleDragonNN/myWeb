var ne=Object.defineProperty,ie=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var O=(t,e,i)=>e in t?ne(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,I=(t,e)=>{for(var i in e||(e={}))de.call(e,i)&&O(t,i,e[i]);if(A)for(var i of A(e))re.call(e,i)&&O(t,i,e[i]);return t},U=(t,e)=>ie(t,le(e));import{v as ce,_ as ue,d as ve,s as _e,r as f,x as he,y as fe,z as me,A as W,b as T,o as c,c as u,e as n,f as B,h as Ye,B as G,C as R,t as m,g as v,F as b,n as w,D as X,q as L,k as J,E as pe,G as ge,N as De}from"./index.032ffb9f.js";import{d as Me,a as d}from"./dayjs.min.5eb3d7e5.js";let P=["eventswipeleft","eventswiperight","eventslideup","eventslidedown","eventclick","eventlongpress"];function Q(t){this.delta={},this.delta.x=t.touches[0].pageX,this.delta.y=t.touches[0].pageY,this.delta.time=new Date().getTime()}function Z(t){let e=this.delta;delete this.delta;let i=new Date().getTime()-e.time;if(e.x-=t.changedTouches[0].pageX,e.y-=t.changedTouches[0].pageY,Math.abs(e.x)<5&&Math.abs(e.y)<5){i<1e3?this.eventclick&&this.eventclick.map(function(o){o(t)}):this.eventlongpress&&this.eventlongpress.map(function(o){o(t)});return}Math.abs(e.x)>Math.abs(e.y)?e.x>0?this.eventswipeleft&&this.eventswipeleft.map(function(o){o(t)}):this.eventswiperight.map(function(o){o(t)}):e.y>0?this.eventslidedown&&this.eventslidedown.map(function(o){o(t)}):this.eventslideup.map(function(o){o(t)})}function ye(t,e,i){t||console.error("dom is null or undefined"),P.some(h=>t[h])||(t.addEventListener("touchstart",Q),t.addEventListener("touchend",Z)),t["event"+e]||(t["event"+e]=[]),t["event"+e].push(i)}function Ee(t,e,i){if(t["event"+e]){for(let o=0;o<t["event"+e].length;o++)t["event"+e][o]===i&&(t["event"+e].splice(o,1),o--);t["event"+e]&&t["event"+e].length===0&&(delete t["event"+e],P.every(h=>!t[h])&&(t.removeEventListener("touchstart",Q),t.removeEventListener("touchend",Z)))}}var K={bindEvent:ye,removeEvent:Ee},Ce={exports:{}};(function(t,e){(function(i,o){t.exports=o(Me.exports)})(ce,function(i){function o(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var h=o(i),C={name:"zh-cn",weekdays:"\u661F\u671F\u65E5_\u661F\u671F\u4E00_\u661F\u671F\u4E8C_\u661F\u671F\u4E09_\u661F\u671F\u56DB_\u661F\u671F\u4E94_\u661F\u671F\u516D".split("_"),weekdaysShort:"\u5468\u65E5_\u5468\u4E00_\u5468\u4E8C_\u5468\u4E09_\u5468\u56DB_\u5468\u4E94_\u5468\u516D".split("_"),weekdaysMin:"\u65E5_\u4E00_\u4E8C_\u4E09_\u56DB_\u4E94_\u516D".split("_"),months:"\u4E00\u6708_\u4E8C\u6708_\u4E09\u6708_\u56DB\u6708_\u4E94\u6708_\u516D\u6708_\u4E03\u6708_\u516B\u6708_\u4E5D\u6708_\u5341\u6708_\u5341\u4E00\u6708_\u5341\u4E8C\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(r,M){return M==="W"?r+"\u5468":r+"\u65E5"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5E74M\u6708D\u65E5",LLL:"YYYY\u5E74M\u6708D\u65E5Ah\u70B9mm\u5206",LLLL:"YYYY\u5E74M\u6708D\u65E5ddddAh\u70B9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5E74M\u6708D\u65E5",lll:"YYYY\u5E74M\u6708D\u65E5 HH:mm",llll:"YYYY\u5E74M\u6708D\u65E5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524D",s:"\u51E0\u79D2",m:"1 \u5206\u949F",mm:"%d \u5206\u949F",h:"1 \u5C0F\u65F6",hh:"%d \u5C0F\u65F6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4E2A\u6708",MM:"%d \u4E2A\u6708",y:"1 \u5E74",yy:"%d \u5E74"},meridiem:function(r,M){var p=100*r+M;return p<600?"\u51CC\u6668":p<900?"\u65E9\u4E0A":p<1100?"\u4E0A\u5348":p<1300?"\u4E2D\u5348":p<1800?"\u4E0B\u5348":"\u665A\u4E0A"}};return h.default.locale(C,null,!0),C})})(Ce);const be={class:"todo"},ke={class:"todo-header"},we={key:0,class:"todo-calendar-container todo-calendar-shrink"},Se={class:"cur-date"},Le={class:"date-month"},$e={class:"date-year"},xe=["onClick"],He={class:"item-day"},Te={class:"item-date"},Be={key:1,class:"todo-calendar-container todo-calendar-expand"},Ve={class:"cur-date"},ze={class:"time"},Ne={class:"item-day-container"},qe={class:"item-day"},Fe={class:"item-date-container"},je=["onClick"],Ae={class:"todo-list"},Oe={key:0,class:"todo-list-content"},Ie={class:"list-time-month"},Ue={class:"list-time-date"},We={class:"inner-content"},Ge=["onClick"],Re={class:"item-title"},Xe={key:0,class:"item-desc"},Je={class:"item-time"},Ke={class:"more-btn"},Pe=["id","onClick"],Qe={class:"iconfont icon-roundcheckfill"},Ze=ve({setup(t){d.locale("zh-cn");const{proxy:e}=_e();f("");const i=he([{name:"\u7F16\u8F91",icon:"edit",desc:"edit"},{name:"\u5220\u9664",icon:"del",desc:"del"}]);f(null);let o=null;const h=[],C=f("more-btn-"),r=f(null),M=f(!1),p=f(!1),k=f(""),Y=f({}),$=f({}),S=f(!1),E=f(d().format("YYYY/MM/DD 00:00")),x=f(!1),V=fe(()=>{let s=[];for(let a=0;a<(p.value?35:7);a++){const _=d().startOf("week").add(a,"day");s[a]={time:_.format("YYYY/MM/DD 00:00"),haveTask:!!Y.value[_.format("YYYYMMDD")]}}return s});me(()=>{K.bindEvent(r.value,"slideup",()=>{p.value=!0}),K.bindEvent(r.value,"slidedown",()=>{p.value=!1})}),z();function z(){const s=W("todo");e.$toast.loading("loading",{cover:!0,duration:0}),s.find().then(a=>{e.$toast.hide(),N(a,Y.value)})}function N(s,a){s.forEach(_=>{const g=d(_.get("dateTime")).format("YYYYMMDD");a[g]||(a[g]=[]),a[g].push(U(I({},_.attributes),{id:_.id}))}),e.$toast.hide()}function ee(s){return s=d(s).format(s.includes(" ")?"YYYY\u5E74MM\u6708DD\u65E5 HH:mm":"YYYY\u5E74MM\u6708DD\u65E5"),s=d().isSame(d(s),"year")?s.split("\u5E74")[1]:s,s}function q(s){E.value=d(s.time).format("YYYY/MM/DD HH:mm"),o&&clearTimeout(o),x.value=!0,o=setTimeout(()=>{x.value=!1},1500),ge(()=>{document.querySelector(".blink").scrollIntoView({behavior:"smooth"})})}function te(s,a){if(!Y.value[s][a])return;let _=X("todo",Y.value[s][a].id);_.set("done",!Y.value[s][a].done),e.$toast.loading("loading",{cover:!0,duration:0}),_.save().then(g=>{e.$toast.hide(),Y.value[s][a].done=!Y.value[s][a].done}).catch(g=>{De.danger(g)})}function H(){if(k.value){S.value=!0,$.value={},e.$toast.loading("loading",{cover:!0,duration:0});const s=W("todo");s.contains("title",k.value),s.find().then(a=>{e.$toast.hide(),N(a,$.value)})}else S.value=!1,Y.value={},z()}function se(s,a){h[0]=s,h[1]=a,C.value="more-btn-"+Y.value[s][a].id,M.value=!M.value}function ae(s){const a=Y.value[h[0]],_=C.value.replace("more-btn-","");({edit:()=>{sessionStorage.setItem("todoEditInfo",JSON.stringify(a[h[1]])),e.$router.push({path:"/schedule/editTodo",query:{id:a[h[1]].id}})},del:()=>{let g=X("todo",_);e.$toast.loading("loading",{cover:!0,duration:0}),g.destroy().then(F=>{e.$toast.hide(),k.value?H():a.splice(h[1],1)})}})[s.desc]()}return(s,a)=>{const _=T("nut-icon"),g=T("nut-searchbar"),F=T("nut-popover");return c(),u("div",be,[n("div",ke,[B(g,{class:"search-bar",placeholder:"\u641C\u7D22",modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=l=>k.value=l),onClear:H,onSearch:H},{leftin:Ye(()=>[B(_,{size:"14",name:"search2"})]),_:1},8,["modelValue"])]),G(n("div",{class:"todo-calendar",ref_key:"calendarRef",ref:r},[p.value?(c(),u("div",Be,[n("div",Ve,m(v(d)(E.value).format("YYYY\u5E74M\u6708")),1),n("div",ze,[n("div",Ne,[(c(),u(b,null,w(7,l=>n("div",qe,"\u5468"+m("\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u65E5"[l-1]),1)),64))]),n("div",Fe,[(c(!0),u(b,null,w(v(V),(l,y)=>(c(),u("div",{class:"item-date",onClick:D=>q(l)},[n("div",{class:L({today:v(d)().isSame(l.time,"date"),active:E.value===l.time,gray:!v(d)().isSame(l.time,"month"),have:l.haveTask})},m(v(d)(l.time).format("DD")),3)],8,je))),256))])])])):(c(),u("div",we,[n("div",Se,[n("div",Le,m(v(d)(E.value).format("M\u6708")),1),n("div",$e,m(v(d)(E.value).format("YYYY")),1)]),(c(!0),u(b,null,w(v(V),(l,y)=>(c(),u("div",{class:L(["time",{today:v(d)().isSame(l.time,"date"),active:E.value===l.time,have:l.haveTask}]),onClick:D=>q(l)},[n("div",He,"\u5468"+m("\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u65E5"[y]),1),n("div",Te,m(v(d)(l.time).format("DD")),1)],10,xe))),256))]))],512),[[R,!S.value]]),n("div",Ae,[(c(!0),u(b,null,w(S.value?$.value:Y.value,(l,y)=>(c(),u(b,null,[l.length?(c(),u("div",Oe,[n("div",{class:L(["list-time",{blink:x.value&&y===v(d)(E.value).format("YYYYMMDD")}])},[n("div",Ie,m(v(d)(y).format("M\u6708")),1),n("div",Ue,m(v(d)(y).format("DD")),1)],2),n("div",We,[(c(!0),u(b,null,w(l,(D,j)=>(c(),u("div",{class:L(["todo-list-item",{done:D.done}]),onClick:oe=>te(y,j)},[n("div",Re,m(D.title),1),D.desc?(c(),u("div",Xe,m(D.desc),1)):J("",!0),n("div",Je,m(ee(D.dateTime)),1),n("div",Ke,[n("i",{class:"iconfont icon-i-more",id:"more-btn-"+D.id,onClick:pe(oe=>se(y,j),["stop"])},null,8,Pe)]),G(n("i",Qe,null,512),[[R,D.done]])],10,Ge))),256))])])):J("",!0)],64))),256))]),B(F,{visible:M.value,"onUpdate:visible":a[1]||(a[1]=l=>M.value=l),targetId:C.value,overlay:!0,"overlay-style":{opacity:"0"},list:v(i),location:"left-start",onChoose:ae},null,8,["visible","targetId","list"])])}}});var at=ue(Ze,[["__scopeId","data-v-17de4ad0"]]);export{at as default};
