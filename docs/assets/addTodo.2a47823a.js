import{_ as j,d as A,m as S,a as q,r,v as x,b as n,o as z,c as H,e as l,g as J,f as u,t as _,h as i,B as C,I as g,l as O,D as R,J as W,A as D,s as E}from"./index.45a74e34.js";import{a as b}from"./dayjs.min.b79eb16e.js";const G={class:"add-todo"},K={class:"header-title"},L={class:"label"},P={class:"label"},Q=A({__name:"addTodo",setup(X){const{proxy:p}=S(),y=q(),v=r(!1),t=x({title:"",desc:"",date:b().format("YYYY-MM-DD"),time:""}),F=r(null),V=x({desc:[{message:"\u8BF7\u8F93\u5165\u5907\u6CE8"}]}),m=r(!1),c=r(!1),f=r(new Date(b().format("YYYY-MM-DD HH:mm:00")));if(p.$route.path==="/schedule/editTodo"){v.value=!0;const o=JSON.parse(sessionStorage.getItem("todoEditInfo"));t.title=o.title,t.desc=o.desc,t.date=o.dateTime.split(" ")[0],t.time=o.dateTime.split(" ")[1]||""}function $(){F.value.validate().then(({valid:o,errors:e})=>{if(o){console.log(t);let a=v.value?R("todo",p.$route.query.id):W("todo");a.set("title",t.title),a.set("desc",t.desc),a.set("done",!1),a.set("dateTime",t.time?t.date+" "+t.time:t.date),D.loading("loading",{cover:!0,duration:0}),a.save().then(d=>{D.hide(),E.success("\u4FDD\u5B58\u6210\u529F"),p.$router.go(-1)}).catch(d=>{E.danger(d)})}else console.log(e)})}function k(o){t.date=o[3]}function T(o){const e=o.selectedValue;f.value=new Date(b().format("YYYY-MM-DD ")+`${e[0]}:${e[1]}:${e[2]}`),t.time=`${e[0]}:${e[1]}:${e[2]}`,c.value=!1}const Y=(o,e)=>{const a={year:()=>e.text+="\u5E74",month:()=>e.text+="\u6708",day:()=>e.text+="\u65E5",hour:()=>e.text+="\u65F6",minute:()=>e.text+="\u5206"};return a[o]&&a[o](),e};return(o,e)=>{const a=n("nut-icon"),d=n("nut-form-item"),B=n("nut-button"),M=n("nut-cell"),w=n("nut-form"),I=n("nut-calendar"),N=n("nut-date-picker"),U=n("nut-popup");return z(),H("div",G,[l("header",null,[l("div",{class:"btn-back",onClick:e[0]||(e[0]=s=>J(y).go(-1))},[u(a,{name:"rect-left",size:"1.1rem"})]),l("div",K,_(v.value?"\u7F16\u8F91\u5F85\u529E":"\u65B0\u589E\u5F85\u529E"),1)]),l("main",null,[u(w,{modelValue:t,rules:V,ref_key:"ruleForm",ref:F},{default:i(()=>[u(d,{prop:"title",required:""},{default:i(()=>[e[9]||(e[9]=l("div",{class:"label"},"\u6807\u9898",-1)),C(l("input",{class:"nut-input-text","onUpdate:modelValue":e[1]||(e[1]=s=>t.title=s),placeholder:"\u8BF7\u8F93\u5165\u6807\u9898",type:"text"},null,512),[[g,t.title]])]),_:1}),u(d,{prop:"desc"},{default:i(()=>[e[10]||(e[10]=l("div",{class:"label"},"\u5907\u6CE8",-1)),C(l("input",{class:"nut-input-text","onUpdate:modelValue":e[2]||(e[2]=s=>t.desc=s),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"text"},null,512),[[g,t.desc]])]),_:1}),u(d,null,{default:i(()=>[e[12]||(e[12]=l("div",{class:"label"},"\u65E5\u671F",-1)),l("section",{class:"date",onClick:e[3]||(e[3]=s=>m.value=!0)},[l("div",L,_(t.date),1),e[11]||(e[11]=l("i",{class:"iconfont icon-rili"},null,-1))])]),_:1}),u(d,null,{default:i(()=>[e[14]||(e[14]=l("div",{class:"label"},"\u65F6\u95F4",-1)),l("section",{class:"date",onClick:e[4]||(e[4]=s=>c.value=!0)},[l("div",P,_(t.time.slice(0,-3)||"\u9009\u62E9"),1),e[13]||(e[13]=l("i",{class:"iconfont icon-shijian"},null,-1))])]),_:1}),u(M,{class:"submit-container"},{default:i(()=>[u(B,{type:"primary",disabled:!t.title,block:"",color:"rgb(106, 116, 205)",size:"large",onClick:$},{default:i(()=>[...e[15]||(e[15]=[O("\u63D0\u4EA4",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["modelValue","rules"]),u(I,{visible:m.value,"onUpdate:visible":e[5]||(e[5]=s=>m.value=s),onClose:e[6]||(e[6]=s=>m.value=!1),onChoose:k,"default-value":t.date,"start-date":null,"end-date":null,isAutoBackFill:!0},null,8,["visible","default-value"]),u(U,{visible:c.value,"onUpdate:visible":e[8]||(e[8]=s=>c.value=s),position:"bottom"},{default:i(()=>[u(N,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=s=>f.value=s),title:"\u65F6\u95F4\u9009\u62E9",formatter:Y,type:"time",onConfirm:T},null,8,["modelValue"])]),_:1},8,["visible"])])])}}});var ee=j(Q,[["__scopeId","data-v-5ea30a20"]]);export{ee as default};
