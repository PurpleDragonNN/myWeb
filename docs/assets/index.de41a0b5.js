import{j as gt,d as st,m as dt,s as ft,r as Z,k as Q,l as vt,a as w,o as X,n as pt,w as y,b as l,u as i,e as at,t as it,i as mt,q as rt,v as yt,c as ht,f as Dt,x as tt,N as Mt,y as St,T as lt,z as ct}from"./index.44d9711b.js";import{c as _t,a as $t}from"./index.a7eaf39a.js";import{_ as ot}from"./plugin-vue_export-helper.21dcd24c.js";var bt={exports:{}};(function(G,E){(function(Y,m){G.exports=m()})(gt,function(){var Y=1e3,m=6e4,B=36e5,h="millisecond",F="second",u="minute",x="hour",O="day",T="week",d="month",g="quarter",M="year",S="date",H="Invalid Date",U=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,D=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},j=function(o,n,t){var a=String(o);return!a||a.length>=n?o:""+Array(n+1-a.length).join(t)+o},et={s:j,z:function(o){var n=-o.utcOffset(),t=Math.abs(n),a=Math.floor(t/60),e=t%60;return(n<=0?"+":"-")+j(a,2,"0")+":"+j(e,2,"0")},m:function o(n,t){if(n.date()<t.date())return-o(t,n);var a=12*(t.year()-n.year())+(t.month()-n.month()),e=n.clone().add(a,d),s=t-e<0,r=n.clone().add(a+(s?-1:1),d);return+(-(a+(t-e)/(s?e-r:r-e))||0)},a:function(o){return o<0?Math.ceil(o)||0:Math.floor(o)},p:function(o){return{M:d,y:M,w:T,d:O,D:S,h:x,m:u,s:F,ms:h,Q:g}[o]||String(o||"").toLowerCase().replace(/s$/,"")},u:function(o){return o===void 0}},V="en",k={};k[V]=p;var P=function(o){return o instanceof L},q=function o(n,t,a){var e;if(!n)return V;if(typeof n=="string"){var s=n.toLowerCase();k[s]&&(e=s),t&&(k[s]=t,e=s);var r=n.split("-");if(!e&&r.length>1)return o(r[0])}else{var f=n.name;k[f]=n,e=f}return!a&&e&&(V=e),e||!a&&V},$=function(o,n){if(P(o))return o.clone();var t=typeof n=="object"?n:{};return t.date=o,t.args=arguments,new L(t)},c=et;c.l=q,c.i=P,c.w=function(o,n){return $(o,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var L=function(){function o(t){this.$L=q(t.locale,null,!0),this.parse(t)}var n=o.prototype;return n.parse=function(t){this.$d=function(a){var e=a.date,s=a.utc;if(e===null)return new Date(NaN);if(c.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var r=e.match(U);if(r){var f=r[2]-1||0,b=(r[7]||"0").substring(0,3);return s?new Date(Date.UTC(r[1],f,r[3]||1,r[4]||0,r[5]||0,r[6]||0,b)):new Date(r[1],f,r[3]||1,r[4]||0,r[5]||0,r[6]||0,b)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},n.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},n.$utils=function(){return c},n.isValid=function(){return this.$d.toString()!==H},n.isSame=function(t,a){var e=$(t);return this.startOf(a)<=e&&e<=this.endOf(a)},n.isAfter=function(t,a){return $(t)<this.startOf(a)},n.isBefore=function(t,a){return this.endOf(a)<$(t)},n.$g=function(t,a,e){return c.u(t)?this[a]:this.set(e,t)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(t,a){var e=this,s=!!c.u(a)||a,r=c.p(t),f=function(W,N){var I=c.w(e.$u?Date.UTC(e.$y,N,W):new Date(e.$y,N,W),e);return s?I:I.endOf(O)},b=function(W,N){return c.w(e.toDate()[W].apply(e.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(N)),e)},_=this.$W,C=this.$M,z=this.$D,A="set"+(this.$u?"UTC":"");switch(r){case M:return s?f(1,0):f(31,11);case d:return s?f(1,C):f(0,C+1);case T:var J=this.$locale().weekStart||0,R=(_<J?_+7:_)-J;return f(s?z-R:z+(6-R),C);case O:case S:return b(A+"Hours",0);case x:return b(A+"Minutes",1);case u:return b(A+"Seconds",2);case F:return b(A+"Milliseconds",3);default:return this.clone()}},n.endOf=function(t){return this.startOf(t,!1)},n.$set=function(t,a){var e,s=c.p(t),r="set"+(this.$u?"UTC":""),f=(e={},e[O]=r+"Date",e[S]=r+"Date",e[d]=r+"Month",e[M]=r+"FullYear",e[x]=r+"Hours",e[u]=r+"Minutes",e[F]=r+"Seconds",e[h]=r+"Milliseconds",e)[s],b=s===O?this.$D+(a-this.$W):a;if(s===d||s===M){var _=this.clone().set(S,1);_.$d[f](b),_.init(),this.$d=_.set(S,Math.min(this.$D,_.daysInMonth())).$d}else f&&this.$d[f](b);return this.init(),this},n.set=function(t,a){return this.clone().$set(t,a)},n.get=function(t){return this[c.p(t)]()},n.add=function(t,a){var e,s=this;t=Number(t);var r=c.p(a),f=function(C){var z=$(s);return c.w(z.date(z.date()+Math.round(C*t)),s)};if(r===d)return this.set(d,this.$M+t);if(r===M)return this.set(M,this.$y+t);if(r===O)return f(1);if(r===T)return f(7);var b=(e={},e[u]=m,e[x]=B,e[F]=Y,e)[r]||1,_=this.$d.getTime()+t*b;return c.w(_,this)},n.subtract=function(t,a){return this.add(-1*t,a)},n.format=function(t){var a=this,e=this.$locale();if(!this.isValid())return e.invalidDate||H;var s=t||"YYYY-MM-DDTHH:mm:ssZ",r=c.z(this),f=this.$H,b=this.$m,_=this.$M,C=e.weekdays,z=e.months,A=function(N,I,nt,K){return N&&(N[I]||N(a,s))||nt[I].slice(0,K)},J=function(N){return c.s(f%12||12,N,"0")},R=e.meridiem||function(N,I,nt){var K=N<12?"AM":"PM";return nt?K.toLowerCase():K},W={YY:String(this.$y).slice(-2),YYYY:this.$y,M:_+1,MM:c.s(_+1,2,"0"),MMM:A(e.monthsShort,_,z,3),MMMM:A(z,_),D:this.$D,DD:c.s(this.$D,2,"0"),d:String(this.$W),dd:A(e.weekdaysMin,this.$W,C,2),ddd:A(e.weekdaysShort,this.$W,C,3),dddd:C[this.$W],H:String(f),HH:c.s(f,2,"0"),h:J(1),hh:J(2),a:R(f,b,!0),A:R(f,b,!1),m:String(b),mm:c.s(b,2,"0"),s:String(this.$s),ss:c.s(this.$s,2,"0"),SSS:c.s(this.$ms,3,"0"),Z:r};return s.replace(D,function(N,I){return I||W[N]||r.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(t,a,e){var s,r=c.p(a),f=$(t),b=(f.utcOffset()-this.utcOffset())*m,_=this-f,C=c.m(this,f);return C=(s={},s[M]=C/12,s[d]=C,s[g]=C/3,s[T]=(_-b)/6048e5,s[O]=(_-b)/864e5,s[x]=_/B,s[u]=_/m,s[F]=_/Y,s)[r]||_,e?C:c.a(C)},n.daysInMonth=function(){return this.endOf(d).$D},n.$locale=function(){return k[this.$L]},n.locale=function(t,a){if(!t)return this.$L;var e=this.clone(),s=q(t,a,!0);return s&&(e.$L=s),e},n.clone=function(){return c.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},o}(),v=L.prototype;return $.prototype=v,[["$ms",h],["$s",F],["$m",u],["$H",x],["$W",O],["$M",d],["$y",M],["$D",S]].forEach(function(o){v[o[1]]=function(n){return this.$g(n,o[0],o[1])}}),$.extend=function(o,n){return o.$i||(o(n,L,$),o.$i=!0),$},$.locale=q,$.isDayjs=P,$.unix=function(o){return $(1e3*o)},$.en=k[V],$.Ls=k,$.p={},$})})(bt);var ut=bt.exports;const Ct=tt("\u4EAC\u4E1C"),wt=tt("\u6DD8\u5B9D"),Ft={key:0},Nt=tt("\u63D0\u4EA4"),Vt=st({setup(G){const E=dt(),{userInfo:Y}=ft(E);let m=_t("order");$t("order");let B=Z(ut().format("YYYY-MM-DD")),h=Z(!1);const F=Z(null);let u=Q({channel:"\u4EAC\u4E1C",count:1,date:ut().format("YYYY-MM-DD"),product:"",payment:null,earn:null,fanli:0});const x=D=>{h.value=!0},O=D=>{h.value=!1},T=D=>{u.date=D[3]},d=Q({product:[{required:!0,message:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"}],payment:[{required:!0,message:"\u8BF7\u8F93\u5165\u5B9E\u4ED8\u91D1\u989D"}],earn:[{required:!0,message:"\u8BF7\u8F93\u5165\u8FD4\u5355\u91D1\u989D"}],fanli:[{required:!1,message:"\u8BF7\u8F93\u5165\u8FD4\u5229\u91D1\u989D"}],phone:[{validator:D=>!D||/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/.test(D),message:"\u624B\u673A\u53F7\u7801\u683C\u5F0F\u4E0D\u6B63\u786E"}]});let g=vt(()=>{let D=Number(u.earn)-Number(u.payment)+Number(u.fanli);return isNaN(D)?0:D});const M=()=>{isNaN(u.earn)&&(u.earn=null),isNaN(u.payment)&&(u.payment=null),isNaN(u.fanli)&&(u.fanli=0)},S=()=>{F.value.validate().then(({valid:D,errors:p})=>{D?H():console.log("error submit!!",p)})},H=()=>{m.set("channel",u.channel),m.set("count",Number(u.count)),m.set("date",u.date),m.set("product",u.product),m.set("payment",Number(u.payment)),m.set("earn",Number(u.earn)),m.set("fanli",Number(u.fanli)),m.set("isFinish",!1),m.set("username",Y.value.username),m.set("userObjectId",Y.value.objectId),m.save().then(D=>{Mt.success("\u63D0\u4EA4\u6210\u529F"),U()})},U=()=>{u.channel="\u4EAC\u4E1C",u.count=1,u.date=ut().format("YYYY-MM-DD"),u.product="",u.payment=null,u.earn=null,u.fanli=0};return(D,p)=>{const j=w("nut-radio"),et=w("nut-radiogroup"),V=w("nut-form-item"),k=w("nut-inputnumber"),P=w("nut-calendar"),q=w("nut-price"),$=w("nut-cell"),c=w("nut-button"),L=w("nut-form");return X(),pt(L,{"model-value":i(u),ref_key:"formRef",ref:F},{default:y(()=>[l(V,{prop:"channel"},{default:y(()=>[l(et,{modelValue:i(u).channel,"onUpdate:modelValue":p[0]||(p[0]=v=>i(u).channel=v),direction:"horizontal"},{default:y(()=>[l(j,{shape:"button",label:"\u4EAC\u4E1C"},{default:y(()=>[Ct]),_:1}),l(j,{shape:"button",label:"\u6DD8\u5B9D"},{default:y(()=>[wt]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(V,{label:"\u4E0B\u5355\u6570\u91CF",prop:"count"},{default:y(()=>[l(k,{modelValue:i(u).count,"onUpdate:modelValue":p[1]||(p[1]=v=>i(u).count=v),"input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1}),l(V,{label:"\u9009\u62E9\u4E0B\u5355\u65E5\u671F",prop:"channel"},{default:y(()=>[at("span",{onClick:p[2]||(p[2]=v=>x())},it(i(u).date?i(u).date:"\u8BF7\u9009\u62E9"),1),l(P,{visible:i(h),"onUpdate:visible":p[3]||(p[3]=v=>mt(h)?h.value=v:h=v),onClose:p[4]||(p[4]=v=>O()),onChoose:T,"default-value":i(u).date,"start-date":"2022-01-01","end-date":i(B),"is-auto-back-fill":!0},null,8,["visible","default-value","end-date"])]),_:1}),l(V,{label:"\u5546\u54C1\u540D\u79F0",required:"",prop:"product",rules:i(d).product},{default:y(()=>[rt(at("input",{class:"nut-input-text",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",type:"text","onUpdate:modelValue":p[5]||(p[5]=v=>i(u).product=v)},null,512),[[yt,i(u).product]])]),_:1},8,["rules"]),l(V,{label:"\u8FD4\u5355\u91D1\u989D",required:"",prop:"earn",rules:i(d).earn},{default:y(()=>[l(k,{modelValue:i(u).earn,"onUpdate:modelValue":p[6]||(p[6]=v=>i(u).earn=v),onBlur:M,min:"0",step:"1","decimal-places":"2","input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1},8,["rules"]),l(V,{label:"\u5B9E\u4ED8\u91D1\u989D",required:"",prop:"payment",rules:i(d).payment},{default:y(()=>[l(k,{modelValue:i(u).payment,"onUpdate:modelValue":p[7]||(p[7]=v=>i(u).payment=v),onBlur:M,min:"0",step:"1","decimal-places":"2","input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1},8,["rules"]),l(V,{label:"\u8FD4\u5229\u91D1\u989D",prop:"fanli",rules:i(d).fanli},{default:y(()=>[l(k,{modelValue:i(u).fanli,"onUpdate:modelValue":p[8]||(p[8]=v=>i(u).fanli=v),onBlur:M,min:"0",step:"1","decimal-places":"2","input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1},8,["rules"]),l($,{title:"\u9884\u8BA1\u76C8\u5229"},{default:y(()=>[!isNaN(i(g))&&i(g)?(X(),ht("span",Ft,it(`${Number(i(u).earn)} + ${Number(i(u).fanli)} - ${Number(i(u).payment)} = `),1)):Dt("",!0),l(q,{price:i(g),size:"large","need-symbol":!1,thousands:!0},null,8,["price"])]),_:1}),l($,null,{default:y(()=>[l(c,{class:"submit-btn",type:"primary",block:"",onClick:S},{default:y(()=>[Nt]),_:1})]),_:1})]),_:1},8,["model-value"])}}});var Et=ot(Vt,[["__scopeId","data-v-70f0ccac"]]);const Bt={class:"table-container"},xt=tt("\u5237\u65B0"),Ot=st({setup(G){const E=dt(),{userInfo:Y}=ft(E);_t("order");let m=$t("order");const B=Q({tabVal:"0"}),h=Q({currentPage:1,pageSize:5,total:100});let F=Z([]);const u=Q({tableHead:[{title:"\u65E5\u671F",key:"date",align:"center"},{title:"\u540D\u79F0",key:"product",align:"center"},{title:"\u76C8\u5229",key:"totalEarn",align:"center"},{title:"\u8FD4\u5355",key:"earn",align:"center"},{title:"\u5B9E\u4ED8",key:"payment",align:"center"},{title:"\u8FD4\u5229",key:"fanli",align:"center"},{title:"\u6570\u91CF",key:"count",align:"center"},{title:"\u5E73\u53F0",key:"channel",align:"center"}]});St(()=>{x()});const x=()=>{m.equalTo("userObjectId",Y.value.objectId),m.descending("createdAt"),m.limit(h.pageSize),console.log((h.currentPage-1)*h.pageSize),m.skip((h.currentPage-1)*h.pageSize),lt.loading("\u52A0\u8F7D\u4E2D"),m.findAndCount().then(([d,g])=>{lt.hide(),h.total=g,F.value=[];for(let M of d){let S=M.toJSON();S.totalEarn=T(T(S.earn,S.fanli),-S.payment),F.value.push(S)}})},O=d=>{console.log(d),h.currentPage=d,x()},T=(d,g)=>(d=String(d).includes(".")?Number(String(d).replace(".","")):d*100,g=String(g).includes(".")?Number(String(g).replace(".","")):g*100,(d+g)/100);return(d,g)=>{const M=w("nut-table"),S=w("nut-pagination"),H=w("nut-button"),U=w("nut-tabpane"),D=w("nut-tabs");return X(),pt(D,{modelValue:i(B).tabVal,"onUpdate:modelValue":g[1]||(g[1]=p=>i(B).tabVal=p),type:"smile"},{default:y(()=>[l(U,{title:"\u672A\u5B8C\u6210"},{default:y(()=>[at("div",Bt,[l(M,{columns:i(u).tableHead,data:i(F),striped:""},null,8,["columns","data"])]),l(S,{modelValue:i(h).currentPage,"onUpdate:modelValue":g[0]||(g[0]=p=>i(h).currentPage=p),"total-items":i(h).total,"items-per-page":i(h).pageSize,"show-page-size":3,"force-ellipses":"",onChange:O},null,8,["modelValue","total-items","items-per-page"]),l(H,{type:"primary",onClick:x},{default:y(()=>[xt]),_:1})]),_:1}),l(U,{title:"\u5DF2\u5B8C\u6210"}),l(U,{title:"\u6240\u6709"})]),_:1},8,["modelValue"])}}});var kt=ot(Ot,[["__scopeId","data-v-58f17d3a"]]);const Yt={class:"container"},Tt=st({setup(G){let E=Z(1);function Y(m,B){E.value=B}return(m,B)=>{const h=w("nut-tabbar-item"),F=w("nut-tabbar");return X(),ht("div",Yt,[l(F,{onTabSwitch:Y,visible:i(E),"onUpdate:visible":B[0]||(B[0]=u=>mt(E)?E.value=u:E=u)},{default:y(()=>[l(h,{"tab-title":"\u586B\u5355",icon:"home"}),l(h,{"tab-title":"\u5217\u8868",icon:"category"})]),_:1},8,["visible"]),rt(l(Et,null,null,512),[[ct,i(E)===0]]),rt(l(kt,null,null,512),[[ct,i(E)===1]])])}}});var Ut=ot(Tt,[["__scopeId","data-v-5f019035"]]);export{Ut as default};
