import{j as Mt,d as rt,m as bt,s as vt,r as X,k as et,l as Ct,n as St,a as F,o as N,q as W,w as h,b as f,u as s,e as pt,t as st,i as $t,v as ht,x as wt,c as A,f as nt,y as it,T as G,N as Nt,z as Ft,F as ct,A as dt,B as kt,C as _t}from"./index.2aa6019d.js";import{c as yt,a as gt,b as Tt}from"./index.ccd9dc81.js";import{_ as ot}from"./plugin-vue_export-helper.21dcd24c.js";var Dt={exports:{}};(function(J,y){(function(O,C){J.exports=C()})(Mt,function(){var O=1e3,C=6e4,_=36e5,Y="millisecond",c="second",v="minute",n="hour",p="day",z="week",T="month",I="quarter",w="year",V="date",S="Invalid Date",B=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,j=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,$={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},l=function(a,u,t){var r=String(a);return!r||r.length>=u?a:""+Array(u+1-r.length).join(t)+a},P={s:l,z:function(a){var u=-a.utcOffset(),t=Math.abs(u),r=Math.floor(t/60),e=t%60;return(u<=0?"+":"-")+l(r,2,"0")+":"+l(e,2,"0")},m:function a(u,t){if(u.date()<t.date())return-a(t,u);var r=12*(t.year()-u.year())+(t.month()-u.month()),e=u.clone().add(r,T),o=t-e<0,i=u.clone().add(r+(o?-1:1),T);return+(-(r+(t-e)/(o?e-i:i-e))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:T,y:w,w:z,d:p,D:V,h:n,m:v,s:c,ms:Y,Q:I}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},x="en",g={};g[x]=$;var U=function(a){return a instanceof Z},R=function a(u,t,r){var e;if(!u)return x;if(typeof u=="string"){var o=u.toLowerCase();g[o]&&(e=o),t&&(g[o]=t,e=o);var i=u.split("-");if(!e&&i.length>1)return a(i[0])}else{var m=u.name;g[m]=u,e=m}return!r&&e&&(x=e),e||!r&&x},D=function(a,u){if(U(a))return a.clone();var t=typeof u=="object"?u:{};return t.date=a,t.args=arguments,new Z(t)},d=P;d.l=R,d.i=U,d.w=function(a,u){return D(a,{locale:u.$L,utc:u.$u,x:u.$x,$offset:u.$offset})};var Z=function(){function a(t){this.$L=R(t.locale,null,!0),this.parse(t)}var u=a.prototype;return u.parse=function(t){this.$d=function(r){var e=r.date,o=r.utc;if(e===null)return new Date(NaN);if(d.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var i=e.match(B);if(i){var m=i[2]-1||0,M=(i[7]||"0").substring(0,3);return o?new Date(Date.UTC(i[1],m,i[3]||1,i[4]||0,i[5]||0,i[6]||0,M)):new Date(i[1],m,i[3]||1,i[4]||0,i[5]||0,i[6]||0,M)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},u.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},u.$utils=function(){return d},u.isValid=function(){return this.$d.toString()!==S},u.isSame=function(t,r){var e=D(t);return this.startOf(r)<=e&&e<=this.endOf(r)},u.isAfter=function(t,r){return D(t)<this.startOf(r)},u.isBefore=function(t,r){return this.endOf(r)<D(t)},u.$g=function(t,r,e){return d.u(t)?this[r]:this.set(e,t)},u.unix=function(){return Math.floor(this.valueOf()/1e3)},u.valueOf=function(){return this.$d.getTime()},u.startOf=function(t,r){var e=this,o=!!d.u(r)||r,i=d.p(t),m=function(Q,E){var L=d.w(e.$u?Date.UTC(e.$y,E,Q):new Date(e.$y,E,Q),e);return o?L:L.endOf(p)},M=function(Q,E){return d.w(e.toDate()[Q].apply(e.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(E)),e)},b=this.$W,k=this.$M,q=this.$D,H="set"+(this.$u?"UTC":"");switch(i){case w:return o?m(1,0):m(31,11);case T:return o?m(1,k):m(0,k+1);case z:var K=this.$locale().weekStart||0,tt=(b<K?b+7:b)-K;return m(o?q-tt:q+(6-tt),k);case p:case V:return M(H+"Hours",0);case n:return M(H+"Minutes",1);case v:return M(H+"Seconds",2);case c:return M(H+"Milliseconds",3);default:return this.clone()}},u.endOf=function(t){return this.startOf(t,!1)},u.$set=function(t,r){var e,o=d.p(t),i="set"+(this.$u?"UTC":""),m=(e={},e[p]=i+"Date",e[V]=i+"Date",e[T]=i+"Month",e[w]=i+"FullYear",e[n]=i+"Hours",e[v]=i+"Minutes",e[c]=i+"Seconds",e[Y]=i+"Milliseconds",e)[o],M=o===p?this.$D+(r-this.$W):r;if(o===T||o===w){var b=this.clone().set(V,1);b.$d[m](M),b.init(),this.$d=b.set(V,Math.min(this.$D,b.daysInMonth())).$d}else m&&this.$d[m](M);return this.init(),this},u.set=function(t,r){return this.clone().$set(t,r)},u.get=function(t){return this[d.p(t)]()},u.add=function(t,r){var e,o=this;t=Number(t);var i=d.p(r),m=function(k){var q=D(o);return d.w(q.date(q.date()+Math.round(k*t)),o)};if(i===T)return this.set(T,this.$M+t);if(i===w)return this.set(w,this.$y+t);if(i===p)return m(1);if(i===z)return m(7);var M=(e={},e[v]=C,e[n]=_,e[c]=O,e)[i]||1,b=this.$d.getTime()+t*M;return d.w(b,this)},u.subtract=function(t,r){return this.add(-1*t,r)},u.format=function(t){var r=this,e=this.$locale();if(!this.isValid())return e.invalidDate||S;var o=t||"YYYY-MM-DDTHH:mm:ssZ",i=d.z(this),m=this.$H,M=this.$m,b=this.$M,k=e.weekdays,q=e.months,H=function(E,L,lt,at){return E&&(E[L]||E(r,o))||lt[L].slice(0,at)},K=function(E){return d.s(m%12||12,E,"0")},tt=e.meridiem||function(E,L,lt){var at=E<12?"AM":"PM";return lt?at.toLowerCase():at},Q={YY:String(this.$y).slice(-2),YYYY:this.$y,M:b+1,MM:d.s(b+1,2,"0"),MMM:H(e.monthsShort,b,q,3),MMMM:H(q,b),D:this.$D,DD:d.s(this.$D,2,"0"),d:String(this.$W),dd:H(e.weekdaysMin,this.$W,k,2),ddd:H(e.weekdaysShort,this.$W,k,3),dddd:k[this.$W],H:String(m),HH:d.s(m,2,"0"),h:K(1),hh:K(2),a:tt(m,M,!0),A:tt(m,M,!1),m:String(M),mm:d.s(M,2,"0"),s:String(this.$s),ss:d.s(this.$s,2,"0"),SSS:d.s(this.$ms,3,"0"),Z:i};return o.replace(j,function(E,L){return L||Q[E]||i.replace(":","")})},u.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},u.diff=function(t,r,e){var o,i=d.p(r),m=D(t),M=(m.utcOffset()-this.utcOffset())*C,b=this-m,k=d.m(this,m);return k=(o={},o[w]=k/12,o[T]=k,o[I]=k/3,o[z]=(b-M)/6048e5,o[p]=(b-M)/864e5,o[n]=b/_,o[v]=b/C,o[c]=b/O,o)[i]||b,e?k:d.a(k)},u.daysInMonth=function(){return this.endOf(T).$D},u.$locale=function(){return g[this.$L]},u.locale=function(t,r){if(!t)return this.$L;var e=this.clone(),o=R(t,r,!0);return o&&(e.$L=o),e},u.clone=function(){return d.w(this.$d,this)},u.toDate=function(){return new Date(this.valueOf())},u.toJSON=function(){return this.isValid()?this.toISOString():null},u.toISOString=function(){return this.$d.toISOString()},u.toString=function(){return this.$d.toUTCString()},a}(),ut=Z.prototype;return D.prototype=ut,[["$ms",Y],["$s",c],["$m",v],["$H",n],["$W",p],["$M",T],["$y",w],["$D",V]].forEach(function(a){ut[a[1]]=function(u){return this.$g(u,a[0],a[1])}}),D.extend=function(a,u){return a.$i||(a(u,Z,D),a.$i=!0),D},D.locale=R,D.isDayjs=U,D.unix=function(a){return D(1e3*a)},D.en=g[x],D.Ls=g,D.p={},D})})(Dt);var ft=Dt.exports;const Bt=it("\u4EAC\u4E1C"),Et=it("\u6DD8\u5B9D"),Ot={key:0},Vt=it("\u63D0\u4EA4"),xt=rt({emits:["submitOrderCb"],setup(J,{emit:y}){const O=bt(),{userInfo:C}=vt(O);let _=yt("order");gt("order");let Y=X(ft().format("YYYY-MM-DD")),c=X(!1);const v=X(null);let n=et({channel:"\u4EAC\u4E1C",count:1,date:ft().format("YYYY-MM-DD"),product:"",payment:null,receive:null,fanli:0});Ct(()=>n.product,$=>{let l=$.match(/\/[0-9]*è¿”/);l&&l[0].match(/[0-9]+/)&&(n.receive=Number(l[0].match(/[0-9]+/)[0]))});const p=$=>{c.value=!0},z=$=>{c.value=!1},T=$=>{n.date=$[3]},I=et({product:[{required:!0,message:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"}],payment:[{required:!0,message:"\u8BF7\u8F93\u5165\u5B9E\u4ED8\u91D1\u989D"}],receive:[{required:!0,message:"\u8BF7\u8F93\u5165\u8FD4\u5355\u91D1\u989D"}],fanli:[{required:!1,message:"\u8BF7\u8F93\u5165\u8FD4\u5229\u91D1\u989D"}],phone:[{validator:$=>!$||/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/.test($),message:"\u624B\u673A\u53F7\u7801\u683C\u5F0F\u4E0D\u6B63\u786E"}]});let w=St(()=>{let $=Number(n.receive)-Number(n.payment)+Number(n.fanli);return isNaN($)?0:$});const V=()=>{isNaN(n.receive)&&(n.receive=null),isNaN(n.payment)&&(n.payment=null),isNaN(n.fanli)&&(n.fanli=0)},S=()=>{v.value.validate().then(({valid:$,errors:l})=>{$?B():console.log("error submit!!",l)})},B=()=>{_.set("channel",n.channel),_.set("count",Number(n.count)),_.set("date",n.date),_.set("product",n.product),_.set("payment",Number(n.payment)),_.set("receive",Number(n.receive)),_.set("fanli",Number(n.fanli)),_.set("isFinish",!1),_.set("username",C.value.username),_.set("userObjectId",C.value.objectId),G.loading("loading"),_.save().then($=>{G.hide(),Nt.success("\u63D0\u4EA4\u6210\u529F"),j(),y("submitOrderCb")})},j=()=>{n.channel="\u4EAC\u4E1C",n.count=1,n.date=ft().format("YYYY-MM-DD"),n.product="",n.payment=null,n.receive=null,n.fanli=0};return($,l)=>{const P=F("nut-radio"),x=F("nut-radiogroup"),g=F("nut-form-item"),U=F("nut-inputnumber"),R=F("nut-calendar"),D=F("nut-price"),d=F("nut-cell"),Z=F("nut-button"),ut=F("nut-form");return N(),W(ut,{"model-value":s(n),ref_key:"formRef",ref:v},{default:h(()=>[f(g,{prop:"channel"},{default:h(()=>[f(x,{modelValue:s(n).channel,"onUpdate:modelValue":l[0]||(l[0]=a=>s(n).channel=a),direction:"horizontal"},{default:h(()=>[f(P,{shape:"button",label:"\u4EAC\u4E1C"},{default:h(()=>[Bt]),_:1}),f(P,{shape:"button",label:"\u6DD8\u5B9D"},{default:h(()=>[Et]),_:1})]),_:1},8,["modelValue"])]),_:1}),f(g,{label:"\u4E0B\u5355\u6570\u91CF",prop:"count"},{default:h(()=>[f(U,{modelValue:s(n).count,"onUpdate:modelValue":l[1]||(l[1]=a=>s(n).count=a),"input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1}),f(g,{label:"\u9009\u62E9\u4E0B\u5355\u65E5\u671F",prop:"channel"},{default:h(()=>[pt("span",{onClick:l[2]||(l[2]=a=>p())},st(s(n).date?s(n).date:"\u8BF7\u9009\u62E9"),1),f(R,{visible:s(c),"onUpdate:visible":l[3]||(l[3]=a=>$t(c)?c.value=a:c=a),onClose:l[4]||(l[4]=a=>z()),onChoose:T,"default-value":s(n).date,"start-date":"2022-01-01","end-date":s(Y),"is-auto-back-fill":!0},null,8,["visible","default-value","end-date"])]),_:1}),f(g,{label:"\u5546\u54C1\u540D\u79F0",required:"",prop:"product",rules:s(I).product},{default:h(()=>[ht(pt("input",{class:"nut-input-text",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",type:"text","onUpdate:modelValue":l[5]||(l[5]=a=>s(n).product=a)},null,512),[[wt,s(n).product]])]),_:1},8,["rules"]),f(g,{label:"\u8FD4\u5355\u91D1\u989D",required:"",prop:"receive",rules:s(I).receive},{default:h(()=>[f(U,{modelValue:s(n).receive,"onUpdate:modelValue":l[6]||(l[6]=a=>s(n).receive=a),onBlur:V,min:"0",step:"1","decimal-places":"2","input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1},8,["rules"]),f(g,{label:"\u5B9E\u4ED8\u91D1\u989D",required:"",prop:"payment",rules:s(I).payment},{default:h(()=>[f(U,{modelValue:s(n).payment,"onUpdate:modelValue":l[7]||(l[7]=a=>s(n).payment=a),onBlur:V,min:"0",step:"1","decimal-places":"2","input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1},8,["rules"]),f(g,{label:"\u8FD4\u5229\u91D1\u989D",prop:"fanli",rules:s(I).fanli},{default:h(()=>[f(U,{modelValue:s(n).fanli,"onUpdate:modelValue":l[8]||(l[8]=a=>s(n).fanli=a),onBlur:V,min:"0",step:"1","decimal-places":"2","input-width":"60","button-size":"28"},null,8,["modelValue"])]),_:1},8,["rules"]),f(d,{title:"\u9884\u8BA1\u76C8\u5229"},{default:h(()=>[!isNaN(s(w))&&s(w)?(N(),A("span",Ot,st(`${Number(s(n).receive)} + ${Number(s(n).fanli)} - ${Number(s(n).payment)} = `),1)):nt("",!0),f(D,{price:s(w),size:"large","need-symbol":!1,thousands:!0},null,8,["price"])]),_:1}),f(d,null,{default:h(()=>[f(Z,{class:"submit-btn",type:"primary",block:"",onClick:S},{default:h(()=>[Vt]),_:1})]),_:1})]),_:1},8,["model-value"])}}});var Yt=ot(xt,[["__scopeId","data-v-0b2d6bfc"]]);const At={class:"table-container"},It={key:0,class:"list-row table-head"},jt={class:"row-item"},Ht=["id"],zt={class:"list-row"},Ut=it("\u5B8C\u6210"),qt=rt({props:{tabNum:{type:Number,default:0}},emits:["changeStatusCb"],setup(J,{expose:y,emit:O}){const C=J,_=bt(),{userInfo:Y}=vt(_);yt("order");let c=gt("order");const v=et({currentPage:1,pageSize:20,total:100});console.log("tabNum:",C.tabNum);const n=X(!0),p=et({tableHead:[{title:"\u65E5\u671F",key:"date"},{title:"\u540D\u79F0",key:"product"},{title:"\u8FD4\u5355",key:"receive",class:"red-color"},{title:"\u5B9E\u4ED8",key:"payment"},{title:"\u8FD4\u5229",key:"fanli"},{title:"\u76C8\u5229",key:"totalEarn"},{title:"\u6570\u91CF",key:"count"},{title:"\u5E73\u53F0",key:"channel"}],listData:[]});Ft(()=>{w(!1)});const z=S=>{w(!0).then(()=>{S()})},T=S=>{w(!1).then(()=>{S()})},I=S=>{let B=Tt("order",S.objectId);B.set("isFinish",!0),G.loading("loading"),B.save().then(j=>{G.hide(),w(!1),O("changeStatusCb")})},w=S=>(S?v.currentPage++:(v.currentPage=1,p.listData.length=0,n.value=!0),c.equalTo("userObjectId",Y.value.objectId),C.tabNum<2&&c.equalTo("isFinish",Boolean(C.tabNum)),c.descending("createdAt"),c.limit(v.pageSize),c.skip((v.currentPage-1)*v.pageSize),G.loading("loading"),c.findAndCount().then(([B,j])=>{G.hide(),v.total=j;for(let $ of B){let l=$.toJSON();l.totalEarn=V(V(l.receive,l.fanli),-l.payment),p.listData.push(l)}console.log(p.listData),p.listData.length>=j&&(n.value=!1)})),V=(S,B)=>(S=String(S).includes(".")?Number(String(S).replace(".","")):S*100,B=String(B).includes(".")?Number(String(B).replace(".","")):B*100,(S+B)/100);return y({}),(S,B)=>{const j=F("nut-button"),$=F("nut-swipe"),l=F("nut-infiniteloading"),P=F("nut-empty");return N(),A("ul",At,[s(p).listData&&s(p).listData.length?(N(),A("div",It,[(N(!0),A(ct,null,dt(s(p).tableHead,x=>(N(),A("div",jt,st(x.title),1))),256))])):nt("",!0),s(p).listData&&s(p).listData.length?(N(),A("div",{key:1,class:"table-body",id:`customScroll${C.tabNum}`},[f(l,{"use-window":!1,"container-id":`customScroll${C.tabNum}`,"has-more":n.value,"is-open-refresh":"",onLoadMore:z,onRefresh:T},{default:h(()=>[(N(!0),A(ct,null,dt(s(p).listData,x=>(N(),W($,{key:x.objectId,disabled:C.tabNum!==0},{right:h(()=>[f(j,{class:"swipe-btn",shape:"square",type:"success",onClick:g=>I(x)},{default:h(()=>[Ut]),_:2},1032,["onClick"])]),default:h(()=>[pt("li",zt,[(N(!0),A(ct,null,dt(s(p).tableHead,g=>(N(),A("div",{class:kt(["row-item",{[`${g.class}`]:g.class}])},st(x[g.key]),3))),256))])]),_:2},1032,["disabled"]))),128))]),_:1},8,["container-id","has-more"])],8,Ht)):(N(),W(P,{key:2,description:"\u6682\u65E0\u8BA2\u5355"}))])}}});var mt=ot(qt,[["__scopeId","data-v-afe2571c"]]);const Lt=rt({setup(J){const y=et({tabVal:0,initTab1:!1,initTab2:!1}),O=({paneKey:_})=>{_===1&&(y.initTab1=!0),_===2&&(y.initTab2=!0)},C=()=>{y.initTab1=!1};return(_,Y)=>{const c=F("nut-tabpane"),v=F("nut-tabs");return N(),W(v,{"auto-height":"",modelValue:s(y).tabVal,"onUpdate:modelValue":Y[0]||(Y[0]=n=>s(y).tabVal=n),type:"smile",onChange:O},{default:h(()=>[f(c,{title:"\u672A\u5B8C\u6210"},{default:h(()=>[f(mt,{"tab-num":0,onChangeStatusCb:C})]),_:1}),f(c,{title:"\u5DF2\u5B8C\u6210"},{default:h(()=>[s(y).initTab1?(N(),W(mt,{key:0,"tab-num":1})):nt("",!0)]),_:1}),f(c,{title:"\u6240\u6709"},{default:h(()=>[s(y).initTab2?(N(),W(mt,{key:0,"tab-num":2})):nt("",!0)]),_:1})]),_:1},8,["modelValue"])}}});var Wt=ot(Lt,[["__scopeId","data-v-2377c695"]]);const Jt={class:"container"},Pt=rt({setup(J){let y=X(0),O=X(!1);function C(Y,c){c===1&&(O.value=!0),y.value=c}function _(){O.value=!1}return(Y,c)=>{const v=F("nut-tabbar-item"),n=F("nut-tabbar");return N(),A("div",Jt,[ht(f(Yt,{class:"main",onSubmitOrderCb:_},null,512),[[_t,s(y)===0]]),s(O)?ht((N(),W(Wt,{key:0,class:"main"},null,512)),[[_t,s(y)===1]]):nt("",!0),f(n,{onTabSwitch:C,visible:s(y),"onUpdate:visible":c[0]||(c[0]=p=>$t(y)?y.value=p:y=p)},{default:h(()=>[f(v,{"tab-title":"\u586B\u5355",icon:"home"}),f(v,{"tab-title":"\u5217\u8868",icon:"category"})]),_:1},8,["visible"])])}}});var Gt=ot(Pt,[["__scopeId","data-v-4bc1c456"]]);export{Gt as default};
