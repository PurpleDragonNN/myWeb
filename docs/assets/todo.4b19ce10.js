var ie=Object.defineProperty,le=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var I=(e,t,i)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,U=(e,t)=>{for(var i in t||(t={}))re.call(t,i)&&I(e,i,t[i]);if(O)for(var i of O(t))ce.call(t,i)&&I(e,i,t[i]);return e},W=(e,t)=>le(e,de(t));import{q as ue,_ as ve,d as _e,m as he,r as h,v as fe,x as me,y as Ye,z as G,A as M,b as V,o as c,c as u,e as n,f as z,h as pe,B as R,C as X,t as f,g as Y,F as k,n as S,D as J,p as x,k as K,E as ge,G as De,s as Me}from"./index.45a74e34.js";import{d as ye,a as d}from"./dayjs.min.b79eb16e.js";let Q=["eventswipeleft","eventswiperight","eventslideup","eventslidedown","eventclick","eventlongpress"];function Z(e){this.delta={},this.delta.x=e.touches[0].pageX,this.delta.y=e.touches[0].pageY,this.delta.time=new Date().getTime()}function ee(e){let t=this.delta;delete this.delta;let i=new Date().getTime()-t.time;if(t.x-=e.changedTouches[0].pageX,t.y-=e.changedTouches[0].pageY,Math.abs(t.x)<5&&Math.abs(t.y)<5){i<1e3?this.eventclick&&this.eventclick.map(function(o){o(e)}):this.eventlongpress&&this.eventlongpress.map(function(o){o(e)});return}Math.abs(t.x)>Math.abs(t.y)?t.x>0?this.eventswipeleft&&this.eventswipeleft.map(function(o){o(e)}):this.eventswiperight.map(function(o){o(e)}):t.y>0?this.eventslidedown&&this.eventslidedown.map(function(o){o(e)}):this.eventslideup.map(function(o){o(e)})}function Ee(e,t,i){e||console.error("dom is null or undefined"),Q.some(_=>e[_])||(e.addEventListener("touchstart",Z),e.addEventListener("touchend",ee)),e["event"+t]||(e["event"+t]=[]),e["event"+t].push(i)}function Ce(e,t,i){if(e["event"+t]){for(let o=0;o<e["event"+t].length;o++)e["event"+t][o]===i&&(e["event"+t].splice(o,1),o--);e["event"+t]&&e["event"+t].length===0&&(delete e["event"+t],Q.every(_=>!e[_])&&(e.removeEventListener("touchstart",Z),e.removeEventListener("touchend",ee)))}}var P={bindEvent:Ee,removeEvent:Ce},be={exports:{}};(function(e,t){(function(i,o){e.exports=o(ye.exports)})(ue,function(i){function o(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var _=o(i),b={name:"zh-cn",weekdays:"\u661F\u671F\u65E5_\u661F\u671F\u4E00_\u661F\u671F\u4E8C_\u661F\u671F\u4E09_\u661F\u671F\u56DB_\u661F\u671F\u4E94_\u661F\u671F\u516D".split("_"),weekdaysShort:"\u5468\u65E5_\u5468\u4E00_\u5468\u4E8C_\u5468\u4E09_\u5468\u56DB_\u5468\u4E94_\u5468\u516D".split("_"),weekdaysMin:"\u65E5_\u4E00_\u4E8C_\u4E09_\u56DB_\u4E94_\u516D".split("_"),months:"\u4E00\u6708_\u4E8C\u6708_\u4E09\u6708_\u56DB\u6708_\u4E94\u6708_\u516D\u6708_\u4E03\u6708_\u516B\u6708_\u4E5D\u6708_\u5341\u6708_\u5341\u4E00\u6708_\u5341\u4E8C\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),ordinal:function(r,y){return y==="W"?r+"\u5468":r+"\u65E5"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5E74M\u6708D\u65E5",LLL:"YYYY\u5E74M\u6708D\u65E5Ah\u70B9mm\u5206",LLLL:"YYYY\u5E74M\u6708D\u65E5ddddAh\u70B9mm\u5206",l:"YYYY/M/D",ll:"YYYY\u5E74M\u6708D\u65E5",lll:"YYYY\u5E74M\u6708D\u65E5 HH:mm",llll:"YYYY\u5E74M\u6708D\u65E5dddd HH:mm"},relativeTime:{future:"%s\u5185",past:"%s\u524D",s:"\u51E0\u79D2",m:"1 \u5206\u949F",mm:"%d \u5206\u949F",h:"1 \u5C0F\u65F6",hh:"%d \u5C0F\u65F6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4E2A\u6708",MM:"%d \u4E2A\u6708",y:"1 \u5E74",yy:"%d \u5E74"},meridiem:function(r,y){var p=100*r+y;return p<600?"\u51CC\u6668":p<900?"\u65E9\u4E0A":p<1100?"\u4E0A\u5348":p<1300?"\u4E2D\u5348":p<1800?"\u4E0B\u5348":"\u665A\u4E0A"}};return _.default.locale(b,null,!0),b})})(be);const ke={class:"todo"},we={class:"todo-header"},Se={key:0,class:"todo-calendar-container todo-calendar-shrink"},Le={class:"cur-date"},xe={class:"date-month"},He={class:"date-year"},Te=["onClick"],Be={class:"item-day"},Ve={class:"item-date"},ze={key:1,class:"todo-calendar-container todo-calendar-expand"},qe={class:"cur-date"},Fe={class:"time"},Ne={class:"item-day-container"},$e={class:"item-day"},je={class:"item-date-container"},Ae=["onClick"],Oe={class:"todo-list"},Ie={key:0,class:"todo-list-content"},Ue={class:"list-time-month"},We={class:"list-time-date"},Ge={class:"inner-content"},Re=["onClick"],Xe={class:"item-title"},Je={key:0,class:"item-desc"},Ke={class:"item-time"},Pe={class:"more-btn"},Qe=["id","onClick"],Ze={class:"iconfont icon-roundcheckfill"},et=_e({__name:"todo",setup(e){d.locale("zh-cn");const{proxy:t}=he();h("");const i=fe([{name:"\u7F16\u8F91",icon:"edit",desc:"edit"},{name:"\u5220\u9664",icon:"del",desc:"del"}]);h(null);let o=null;const _=[],b=h("more-btn-"),r=h(null),y=h(!1),p=h(!1),w=h(""),m=h({}),H=h({}),L=h(!1),C=h(d().format("YYYY/MM/DD 00:00")),T=h(!1),q=me(()=>{let s=[];for(let a=0;a<(p.value?35:7);a++){const v=d().startOf("week").add(a,"day");s[a]={time:v.format("YYYY/MM/DD 00:00"),haveTask:!!m.value[v.format("YYYYMMDD")]}}return s});Ye(()=>{P.bindEvent(r.value,"slideup",()=>{p.value=!0}),P.bindEvent(r.value,"slidedown",()=>{p.value=!1})}),F();function F(){const s=G("todo");M.loading("loading",{cover:!0,duration:0}),s.find().then(a=>{M.hide(),N(a,m.value)})}function N(s,a){s.forEach(v=>{const g=d(v.get("dateTime")).format("YYYYMMDD");a[g]||(a[g]=[]),a[g].push(W(U({},v.attributes),{id:v.id}))}),M.hide()}function te(s){return s=d(s).format(s.includes(" ")?"YYYY\u5E74MM\u6708DD\u65E5 HH:mm":"YYYY\u5E74MM\u6708DD\u65E5"),s=d().isSame(d(s),"year")?s.split("\u5E74")[1]:s,s}function $(s){C.value=d(s.time).format("YYYY/MM/DD HH:mm"),o&&clearTimeout(o),T.value=!0,o=setTimeout(()=>{T.value=!1},1500),De(()=>{document.querySelector(".blink").scrollIntoView({behavior:"smooth"})})}function se(s,a){if(!m.value[s][a])return;let v=J("todo",m.value[s][a].id);v.set("done",!m.value[s][a].done),M.loading("loading",{cover:!0,duration:0}),v.save().then(g=>{M.hide(),m.value[s][a].done=!m.value[s][a].done}).catch(g=>{Me.danger(g)})}function B(){if(w.value){L.value=!0,H.value={},M.loading("loading",{cover:!0,duration:0});const s=G("todo");s.contains("title",w.value),s.find().then(a=>{M.hide(),N(a,H.value)})}else L.value=!1,m.value={},F()}function ae(s,a){_[0]=s,_[1]=a,b.value="more-btn-"+m.value[s][a].id,y.value=!y.value}function oe(s){const a=m.value[_[0]],v=b.value.replace("more-btn-","");({edit:()=>{sessionStorage.setItem("todoEditInfo",JSON.stringify(a[_[1]])),t.$router.push({path:"/schedule/editTodo",query:{id:a[_[1]].id}})},del:()=>{let g=J("todo",v);M.loading("loading",{cover:!0,duration:0}),g.destroy().then(j=>{M.hide(),w.value?B():a.splice(_[1],1)})}})[s.desc]()}return(s,a)=>{const v=V("nut-icon"),g=V("nut-search-bar"),j=V("nut-popover");return c(),u("div",ke,[n("div",we,[z(g,{class:"search-bar",placeholder:"\u641C\u7D22",modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=l=>w.value=l),onClear:B,onSearch:B},{leftin:pe(()=>[z(v,{size:"14",name:"search2"})]),_:1},8,["modelValue"])]),R(n("div",{class:"todo-calendar",ref_key:"calendarRef",ref:r},[p.value?(c(),u("div",ze,[n("div",qe,f(Y(d)(C.value).format("YYYY\u5E74M\u6708")),1),n("div",Fe,[n("div",Ne,[(c(),u(k,null,S(7,l=>n("div",$e,"\u5468"+f("\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u65E5"[l-1]),1)),64))]),n("div",je,[(c(!0),u(k,null,S(q.value,(l,E)=>(c(),u("div",{class:"item-date",onClick:D=>$(l)},[n("div",{class:x({today:Y(d)().isSame(l.time,"date"),active:C.value===l.time,gray:!Y(d)().isSame(l.time,"month"),have:l.haveTask})},f(Y(d)(l.time).format("DD")),3)],8,Ae))),256))])])])):(c(),u("div",Se,[n("div",Le,[n("div",xe,f(Y(d)(C.value).format("M\u6708")),1),n("div",He,f(Y(d)(C.value).format("YYYY")),1)]),(c(!0),u(k,null,S(q.value,(l,E)=>(c(),u("div",{class:x(["time",{today:Y(d)().isSame(l.time,"date"),active:C.value===l.time,have:l.haveTask}]),onClick:D=>$(l)},[n("div",Be,"\u5468"+f("\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u65E5"[E]),1),n("div",Ve,f(Y(d)(l.time).format("DD")),1)],10,Te))),256))]))],512),[[X,!L.value]]),n("div",Oe,[(c(!0),u(k,null,S(L.value?H.value:m.value,(l,E)=>(c(),u(k,null,[l.length?(c(),u("div",Ie,[n("div",{class:x(["list-time",{blink:T.value&&E===Y(d)(C.value).format("YYYYMMDD")}])},[n("div",Ue,f(Y(d)(E).format("M\u6708")),1),n("div",We,f(Y(d)(E).format("DD")),1)],2),n("div",Ge,[(c(!0),u(k,null,S(l,(D,A)=>(c(),u("div",{class:x(["todo-list-item",{done:D.done}]),onClick:ne=>se(E,A)},[n("div",Xe,f(D.title),1),D.desc?(c(),u("div",Je,f(D.desc),1)):K("",!0),n("div",Ke,f(te(D.dateTime)),1),n("div",Pe,[n("i",{class:"iconfont icon-i-more",id:"more-btn-"+D.id,onClick:ge(ne=>ae(E,A),["stop"])},null,8,Qe)]),R(n("i",Ze,null,512),[[X,D.done]])],10,Re))),256))])])):K("",!0)],64))),256))]),z(j,{visible:y.value,"onUpdate:visible":a[1]||(a[1]=l=>y.value=l),targetId:b.value,overlay:!0,"overlay-style":{opacity:"0"},list:i,location:"left-start",onChoose:oe},null,8,["visible","targetId","list"])])}}});var ot=ve(et,[["__scopeId","data-v-1cc777fa"]]);export{ot as default};
